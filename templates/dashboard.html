{% extends "base.html" %}

{% block title %}Dashboard - CZ7 Host{% endblock %}

{% block content %}
<h1>Dashboard de Serviços</h1>
<p>Olá, {{ user.username }}! <a href="/tickets">Ver Tickets</a> | <a href="/api/v1/auth/logout">Logout</a></p>

<h2>Meus Serviços</h2>
<table>
    <thead>
        <tr>
            <th>Nome</th>
            <th>Tipo</th>
            <th>Status</th>
            <th>Ações</th>
        </tr>
    </thead>
    <tbody>
        {% for service in services %}
        <tr>
            <td>{{ service.name }}</td>
            <td>{{ service.service_type.value }}</td>
            <td>
                <span class="status-{{ service_status.get(service.id, 'unknown')|lower }}">
                    {{ service_status.get(service.id, 'unknown') }}
                </span>
            </td>
            <td>
                <form action="/actions/start-service" method="post" style="display: inline;">
                    <input type="hidden" name="service_id" value="{{ service.id }}">
                    <button type="submit" class="btn btn-success">Start</button>
                </form>
                <form action="/actions/stop-service" method="post" style="display: inline;">
                    <input type="hidden" name="service_id" value="{{ service.id }}">
                    <button type="submit" class="btn btn-warning">Stop</button>
                </form>
                <a href="/services/{{ service.id }}/files" class="btn">Files</a>
                <form action="/actions/delete-service" method="post" style="display: inline;">
                    <input type="hidden" name="service_id" value="{{ service.id }}">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="4">Você ainda não tem nenhum serviço.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h2 style="margin-top: 2em;">Criar Novo Serviço</h2>
<form action="/actions/create-service" method="post">
    <input type="text" name="name" placeholder="Nome do Serviço" required>
    <select name="service_type" required>
        {% for st in service_types %}
        <option value="{{ st }}">{{ st }}</option>
        {% endfor %}
    </select>
    <button type="submit" class="btn">Criar</button>
</form>
{% endblock %}